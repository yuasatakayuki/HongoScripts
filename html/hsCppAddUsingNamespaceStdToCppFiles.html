<html>
<body>
<pre>
#!/bin/bash

#20100604 Takayuki Yuasa

if [ _$1 = _ ]; then
echo &quot;give file to be processed...exit&quot;
exit
fi

if [ ! -f $1 ]; then
echo &quot;file not found...exit&quot;
exit
fi

file=$1

backupfile=${file}.before_conversion
cp $file $backupfile

ruby &lt;&lt; EOF
index=0
i=0
has_using_namespace_std=false
open(&quot;$backupfile&quot;).each{|line|
 i=i+1
 if(line.include?(&quot;#include &quot;))then
  index=i
 end
 if(line.include?(&quot;using namespace std;&quot;))then
  has_using_namespace_std=true
 end
}

f=open(&quot;$file&quot;,&quot;w&quot;)

i=0
open(&quot;$backupfile&quot;).each{|line|
 if(i==index and has_using_namespace_std==false)then
  f.print &quot;using namespace std;\n&quot;
 end
 f.print line
 i=i+1
}

f.close()

EOF
</pre>
</body>
</html>
