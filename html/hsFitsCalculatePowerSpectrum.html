<html>
<body>
<pre>
#!/bin/bash

#20090901 Takayuki Yuasa
#20091003 Takayuki Yuasa bug in argument interpretation fixed

if [ _$5 = _ ];
then

echo &quot;<span style="text-decoration:line-through;color:blue;">fits_calculate_power_spectrum.sh</span><span style="color:red;">hsFitsCalculatePowerSpectrum</span> (input event file) (output fits file prefix) (output plot prefix) (bin time in sec) (calculation interval duration in sec) (number of interval per plotted frame;optional)&quot;
exit

fi

windowfile=$hongoscriptsdir/astrophysics/etc/<span style="text-decoration:line-through;color:blue;">xronos_nowindow.wi</span><span style="color:red;">hsFtoolsXronosNoWindow.wi</span>

infile=$1
outputprefix=$2
plotprefix=$3
bin=$4
interval=$5

if [ _$6 = _ ];
then
nintfm=100000
else
nintfm=$6
fi

#files
psfile=${plotprefix}.ps

#number of bins in an interval
#see &quot;fhelp powspec&quot;
nbint=`calc &quot;$interval/$bin&quot;`

#create directory
mkdir -p `dirname $outputprefix` &amp;&gt; /dev/null
mkdir -p `dirname $plotprefix` &amp;&gt; /dev/null

#delete qdp files
<span style="text-decoration:line-through;color:blue;">delete_qdp_files.sh</span><span style="color:red;">hsQDPDeleteQDPFiles</span> ${outputprefix}.qdp
<span style="text-decoration:line-through;color:blue;">delete_qdp_files.sh</span><span style="color:red;">hsQDPDeleteQDPFiles</span> ${plotprefix}.qdp

#calculate power spectrum
powspec \
 cfile1=&quot;$infile&quot; \
 window=$windowfile \
 dtnb=$bin \
 nbint=$nbint \
 nintfm=$nintfm \
 rebin=0 \
 plot=yes \
 plotdev=&quot;/xw&quot; \
 outfile=&quot;${outputprefix}.fps&quot; &lt;&lt; EOF

we $plotprefix
hard $psfile/cps

EOF

#convert ps to pdf
pushd `dirname $plotprefix`

ps2pdf `basename $psfile`

popd
</pre>
</body>
</html>
