<html>
<body>
<pre>
#!/bin/bash

#20090308 Takayuki Yuasa

#check current folder
wd=`<span style="text-decoration:line-through;color:blue;">get_current_foldername</span><span style="color:red;">hsFolderGetCurrentFolderName</span>`
if [ _$wd != _gso ];
then

cat &lt;&lt; EOF
usage : <span style="text-decoration:line-through;color:blue;">gso_barycentric_correction_auto.sh</span><span style="color:red;">hsGSOBarycentricCorrectionAuto</span> (ra; optional) (dec; optional)

Run this command in gso/ folder with no argument.

New event and NXB files will be created in data/ folder
by processing existing event and NXB files.
EOF

exit
fi

#############################################
# parameter setting
#############################################
gsoevtfile=data/gso_evt.evt
if [ ! -f $gsoevtfile ];
then
echo &quot;gso event file ($pinevtfile) is not found...exit&quot;
exit
fi

if [ _$2 = _ ];
then
ra=`<span style="text-decoration:line-through;color:blue;">ra_obj.sh</span><span style="color:red;">hsFitsGetRAOBJ</span> $gsoevtfile`
dec=`<span style="text-decoration:line-through;color:blue;">dec_obj.sh</span><span style="color:red;">hsGetFitsDecObj</span> $gsoevtfile`
else
ra=$1
dec=$2
fi
echo &quot;Target (RA,DEC)=(${ra},${dec})&quot;

orbfile=`ls auxil/ae*.orb 2&gt; /dev/null`
if [ _$orbfile = _ ];
then
echo &quot;orbit file is not found in auxil/ folder...exit&quot;
exit
fi

#############################################
# function
#############################################
function doCorrection(){
#barycentric correction
cp $evtfile $outputfile
aebarycen filelist=$outputfile orbit=$orbfile ra=$ra dec=$dec leapfile=CALDB 
}

#############################################
# body
#############################################
evtfile=data/gso_evt.evt
outputfile=data/gso_evt_barycentric_correction.evt
doCorrection

evtfile=data/gso_nxb.evt
outputfile=data/gso_nxb_barycentric_correction.evt
doCorrection

evtfile=data/pseudo.evt
outputfile=data/pseudo_barycentric_correction.evt
doCorrection
</pre>
</body>
</html>
