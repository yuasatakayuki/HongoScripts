<html>
<body>
<pre>
#!/usr/bin/env ruby

#20121225 Takayuki Yuasa

scriptName=&quot;<span style="text-decoration:line-through;color:blue;">wsHTMLExtractURLsFromHTMLFile</span><span style="color:red;">hsHTMLExtractURLsFromHTMLFile</span>&quot;
scriptUsage=&lt;&lt;EOS
Script Name: #{scriptName}

Description:
Extracts URLs liked from an input HTML file.
href attributes of a tags will be extracted.
Extension filter can be provied.
Base URL can be provided for converting relative links
to complete (absolute) URLs.

Usage:
#{scriptName} (Input HTML File) (Extension filter; optional; &#39;-&#39; for no filter) (Base URL)

Example:
#{scriptName} index.html pdf http://www.abcdef.com/files/
EOS


if(ARGV.length==0)then
print scriptUsage
exit
end

htmlfile=ARGV[0]

extension=&quot;&quot;
if(ARGV.length==2)then
	if(ARGV[1]!=&quot;-&quot;)then
		extension=ARGV[1]
	end
end

baseurl=&quot;&quot;
if(ARGV.length==3)then
	baseurl=ARGV[2]
end


open(htmlfile).each{|line|
	line.chop!()
	(line.scan(/href=&quot;(.*?)&quot;/ )).each{|array|
		 array.each{|e|
		 	result=&quot;&quot;
			 if(extension!=&quot;&quot;)then
			  str=e
			  if(str.include?(extension))then
			   result=&quot;#{$1}&quot;
			  end
			 else
			  result=&quot;#{e}&quot;
			 end
			 result.gsub!(&quot; &quot;,&quot;&quot;)
			 result.gsub!(&quot;\t&quot;,&quot;&quot;)
			 result.gsub!(&quot;\n&quot;,&quot;&quot;)
			 if(result!=&quot;&quot;)then
				 if(!result.include?(&quot;http&quot;))then
				 	result=baseurl+result
				 end
				 print &quot;#{result}\n&quot;
			end
		 }
	}
}
</pre>
</body>
</html>
