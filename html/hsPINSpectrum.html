<html>
<body>
<pre>
#!/bin/bash

#200903xx Takayuki Yuasa
#20090608 Takayuki Yuasa added faking CXB
#20091023 Takayuki Yuasa added extra command file

pwd=`pwd`
if [ `basename $pwd` != spectral_analysis ];
then
echo &quot;run this script at analysis/pin/spectral_analysis/ folder.&quot;
exit
fi

read -p &quot;input tag name &gt; &quot; tag
if [ _$tag = _ ];
then
echo &quot;tag name empty...exit&quot;
exit
fi

read -p &quot;extra condition file (which contains xselect commands) or type \&quot;none\&quot; &gt; &quot; extracommandfile
if [ -f $extracommandfile -o $extracommandfile = &quot;none&quot; ];
then
if [ -f $extracommandfile ];
then
 echo &quot;extra command file ($extracommandfile) was found...OK&quot;
else
 echo &quot;no extra command file is used&quot;
fi
else
echo &quot;extra command file not found...exit&quot;
echo &quot;(if you do not have an extra command file, please type \&quot;none\&quot;&quot;
exit
fi

#create gti
mkdir -p gtis/$tag pis/$tag plots/$tag &amp;&gt; /dev/null
<span style="text-decoration:line-through;color:blue;">pin_merge_gtis.sh</span><span style="color:red;">hsPINMergeGTI</span> &quot;../data/pin_evt.evt+2&quot; &quot;../data/pin_nxb.evt+2&quot; gtis/$tag/cleaned_evt_nxb_merged.gti

#extract spectra
<span style="text-decoration:line-through;color:blue;">pin_extract_spectrum_with_gti.sh</span><span style="color:red;">hsPINExtractSpectrumWithGTI</span> ../data/pin_evt.evt ../data/pseudo.evt gtis/${tag}/cleaned_evt_nxb_merged.gti pis/${tag}/pin_evt_gti_evt_nxb_merged.pi $extracommandfile
<span style="text-decoration:line-through;color:blue;">pin_extract_spectrum_with_gti.sh</span><span style="color:red;">hsPINExtractSpectrumWithGTI</span> ../data/pin_nxb.evt none gtis/${tag}/cleaned_evt_nxb_merged.gti nxbs/${tag}/pin_nxb_gti_evt_nxb_merged.pi $extracommandfile

#fake cxb
<span style="text-decoration:line-through;color:blue;">pin_fake_cxb_auto.sh</span><span style="color:red;">hsPINFakeCXBAuto</span> pis/${tag}/pin_evt_gti_evt_nxb_merged.pi cxbs/cxb.fake

#plot
<span style="text-decoration:line-through;color:blue;">pin_create_spectra_check_plot.sh</span><span style="color:red;">hsPINCreateSpectrumCheckPlot</span> \
 pis/${tag}/pin_evt_gti_evt_nxb_merged_dtcor_bin20.pi \
 nxbs/${tag}/pin_nxb_gti_evt_nxb_merged_times10.pi \
 nxbs/${tag}/pin_nxb_gti_evt_nxb_merged_times200.pi \
 `<span style="text-decoration:line-through;color:blue;">pin_find_responsefile_auto.sh</span><span style="color:red;">hsPINFindResponseFileAuto</span> pis/${tag}/pin_evt_gti_evt_nxb_merged_dtcor_bin20.pi` \
 plots/${tag}/pin_evt_gti_evt_nxb_merged_bin20.pdf
</pre>
</body>
</html>
